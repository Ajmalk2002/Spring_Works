package com.example.demo;

import java.util.List;
import java.util.Map;

import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.stereotype.Repository;

@Repository
public class EmployeeDao {

	
	private final NamedParameterJdbcTemplate namedJdbcTemplate;

    public EmployeeDao(NamedParameterJdbcTemplate namedJdbcTemplate) {
        this.namedJdbcTemplate = namedJdbcTemplate;
    }

    public List<Employee> getAllEmployees() {
        String sql = "SELECT * FROM employee";
        return namedJdbcTemplate.query(sql, Map.of(), new EmployeeRowMapper());
    }

    // ✅ GET BY ID (Named Parameter)
    public Employee getEmployeeById(int id) {
        String sql = "SELECT * FROM employee WHERE id = :id";
        return namedJdbcTemplate.queryForObject(sql, Map.of("id", id), new EmployeeRowMapper());
    }

    // ✅ INSERT (Named Parameters)
    public int addEmployee(Employee emp) {
        String sql = """
            INSERT INTO employee (id, name, salary)
            VALUES (:id, :name, :salary)
        """;

        return namedJdbcTemplate.update(sql, new BeanPropertySqlParameterSource(emp));
    }

}
